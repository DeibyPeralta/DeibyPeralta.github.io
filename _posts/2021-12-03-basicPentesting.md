---
title: "tryhackme: Basic pentesting"
share: false
excerpt: "Esta es una máquina que le permite practicar la piratería de aplicaciones web y la escalada de privilegios."
share: false
header:
  teaser:  /assets/images/basic/logo.png
  teaser_home_page: true
categories:
  - tryhackme
tags:
  - brute forcing 
  - hash cracking 
  - service enumeration
  - Linux Enumeration
  - id_rsa cracking
---

Comprovamos que la maquina este iniciada correctamente enviandole un ping

```bash
❯ ping -c 1 10.10.110.104
PING 10.10.110.104 (10.10.110.104) 56(84) bytes of data.
64 bytes from 10.10.110.104: icmp_seq=1 ttl=63 time=270 ms

--- 10.10.110.104 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 270.163/270.163/270.163/0.000 ms
```

Como podemos ver, recibio el paquete enviado, ademas, mediante el ttl podemos saber que es una maquina _linux_ tambien podemos usar 
la utilidad wichSystem.py

```bash
❯ wichSystem.py 10.10.110.103

10.10.110.103 (ttl -> 63): Linux
```

# Enumeration

Iniciamos el escaneo verificando los puertos abiertos

```bash
❯ sudo nmap -p- --open --min-rate 5000 -sS -Pn -n 10.10.110.103 -oG allPorts
[sudo] password for blanco: 
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-08 08:12 -05
Nmap scan report for 10.10.110.103
Host is up (0.47s latency).
Not shown: 52560 filtered tcp ports (no-response), 12970 closed tcp ports (reset)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
8080/tcp open  http-proxy

Nmap done: 1 IP address (1 host up) scanned in 149.01 seconds
```

con la utilidad extractPorts vemos un poco mejor los puertos abiertos y nos los copia en la clipboar

```bash
❯ extractPorts allPorts
───────┬───────────────────────────────────────────────────────────────────────────────────
       │ File: extractPorts.tmp
───────┼───────────────────────────────────────────────────────────────────────────────────
   1   │ 
   2   │ [*] Extracting information...
   3   │ 
   4   │     [*] IP Address: 10.10.110.103
   5   │     [*] Open ports: 22,80,139,445,8080
   6   │ 
   7   │ [*] Ports copied to clipboard
   8   │ 
───────┴───────────────────────────────────────────────────────────────────────────────────
```

ahora vemos un poco mejor los puertos abiertos, el siguiente proceso a seguir sera, ver posible vulnerabilidades y que serivicios
corren en dichos puertos

```bash
❯ nmap -sC -sV -p22,80,139,445,8080 10.10.110.103
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-08 09:28 -05
Nmap scan report for 10.10.110.103
Host is up (0.18s latency).

PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-favicon: Apache Tomcat
|_http-title: Apache Tomcat/9.0.7
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h39m57s, deviation: 2h53m12s, median: -3s
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2021-12-08T09:28:42-05:00
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb2-time: 
|   date: 2021-12-08T14:28:42
|_  start_date: N/A
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 21.61 seconds
```

- vemos que existe una pagina web en el puerto 80

![web site](/assets/images/basic/web.png)

usando _gobuster_ encontramos un directorio y al verlo en el navegador encontramos lo siguiente:

![development](/assets/images/basic/development.png)


- al recisar el primer archivo encontramos la siguiente información, podria ser una pista para mas adelante, por si acaso,
la guardaremos

![dev](/assets/images/basic/dev.png)

- en el segundo archivo, obtenemos un poco de información muy util  
- ya sabemos que la contraseña es debil, por tanto, usaremos un diccionario que trae parrot

![j](/assets/images/basic/j.png)


Buscamos algo mas de información usando *enum4linux*

```bash
enum4linux 10.10.131.72
Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sun Dec 12 13:31:33 2021

 ========================== 
|    Target Information    |
 ========================== 
Target ........... 10.10.131.72
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ==================================================== 
|    Enumerating Workgroup/Domain on 10.10.131.72    |
 ==================================================== 
[+] Got domain/workgroup name: WORKGROUP

 ============================================ 
|    Nbtstat Information for 10.10.131.72    |
 ============================================ 
Looking up status of 10.10.131.72
        BASIC2          <00> -         B <ACTIVE>  Workstation Service
        BASIC2          <03> -         B <ACTIVE>  Messenger Service
        BASIC2          <20> -         B <ACTIVE>  File Server Service
        ..__MSBROWSE__. <01> - <GROUP> B <ACTIVE>  Master Browser
        WORKGROUP       <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name
        WORKGROUP       <1d> -         B <ACTIVE>  Master Browser
        WORKGROUP       <1e> - <GROUP> B <ACTIVE>  Browser Service Elections

        MAC Address = 00-00-00-00-00-00

 ===================================== 
|    Session Check on 10.10.131.72    |
 ===================================== 
[+] Server 10.10.131.72 allows sessions using username '', password ''

 =========================================== 
|    Getting domain SID for 10.10.131.72    |
 =========================================== 
Domain Name: WORKGROUP
Domain Sid: (NULL SID)
[+] Can't determine if host is part of domain or part of a workgroup

 ====================================== 
|    OS information on 10.10.131.72    |
 ====================================== 
Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.
[+] Got OS info for 10.10.131.72 from smbclient: 
[+] Got OS info for 10.10.131.72 from srvinfo:
        BASIC2         Wk Sv PrQ Unx NT SNT Samba Server 4.3.11-Ubuntu
        platform_id     :       500
        os version      :       6.1
        server type     :       0x809a03

 ============================= 
|    Users on 10.10.131.72    |
 ============================= 
Use of uninitialized value $users in print at ./enum4linux.pl line 874.
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.

Use of uninitialized value $users in print at ./enum4linux.pl line 888.
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.

 ========================================= 
|    Share Enumeration on 10.10.131.72    |
 ========================================= 

        Sharename       Type      Comment
        ---------       ----      -------
        Anonymous       Disk      
        IPC$            IPC       IPC Service (Samba Server 4.3.11-Ubuntu)
SMB1 disabled -- no workgroup available

[+] Attempting to map shares on 10.10.131.72
//10.10.131.72/Anonymous        Mapping: OK, Listing: OK
//10.10.131.72/IPC$     [E] Can't understand response:
NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*

 ==================================================== 
|    Password Policy Information for 10.10.131.72    |
 ==================================================== 


[+] Attaching to 10.10.131.72 using a NULL share

[+] Trying protocol 139/SMB...

[+] Found domain(s):

        [+] BASIC2
        [+] Builtin

[+] Password Info for Domain: BASIC2

        [+] Minimum password length: 5
        [+] Password history length: None
        [+] Maximum password age: 37 days 6 hours 21 minutes 
        [+] Password Complexity Flags: 000000

                [+] Domain Refuse Password Change: 0
                [+] Domain Password Store Cleartext: 0
                [+] Domain Password Lockout Admins: 0
                [+] Domain Password No Clear Change: 0
                [+] Domain Password No Anon Change: 0
                [+] Domain Password Complex: 0

        [+] Minimum password age: None
        [+] Reset Account Lockout Counter: 30 minutes 
        [+] Locked Account Duration: 30 minutes 
        [+] Account Lockout Threshold: None
        [+] Forced Log off Time: 37 days 6 hours 21 minutes 


[+] Retieved partial password policy with rpcclient:

Password Complexity: Disabled
Minimum Password Length: 5


 ============================== 
|    Groups on 10.10.131.72    |
 ============================== 

[+] Getting builtin groups:

[+] Getting builtin group memberships:

[+] Getting local groups:

[+] Getting local group memberships:

[+] Getting domain groups:

[+] Getting domain group memberships:

 ======================================================================= 
|    Users on 10.10.131.72 via RID cycling (RIDS: 500-550,1000-1050)    |
 ======================================================================= 
[I] Found new SID: S-1-22-1
[I] Found new SID: S-1-5-21-2853212168-2008227510-3551253869
[I] Found new SID: S-1-5-32
[+] Enumerating users using SID S-1-5-32 and logon username '', password ''
S-1-5-32-500 *unknown*\*unknown* (8)
S-1-5-32-539 *unknown*\*unknown* (8)
S-1-5-32-540 *unknown*\*unknown* (8)
S-1-5-32-542 *unknown*\*unknown* (8)
S-1-5-32-543 *unknown*\*unknown* (8)
S-1-5-32-544 BUILTIN\Administrators (Local Group)
S-1-5-32-545 BUILTIN\Users (Local Group)
S-1-5-32-546 BUILTIN\Guests (Local Group)
S-1-5-32-547 BUILTIN\Power Users (Local Group)
S-1-5-32-548 BUILTIN\Account Operators (Local Group)
S-1-5-32-549 BUILTIN\Server Operators (Local Group)
S-1-5-32-550 BUILTIN\Print Operators (Local Group)
S-1-5-32-1037 *unknown*\*unknown* (8)
S-1-5-32-1038 *unknown*\*unknown* (8)
S-1-5-32-1039 *unknown*\*unknown* (8)
[+] Enumerating users using SID S-1-22-1 and logon username '', password ''
S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User)
[+] Enumerating users using SID S-1-5-21-2853212168-2008227510-3551253869 and logon username '', password ''
S-1-5-21-2853212168-2008227510-3551253869-500 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-501 BASIC2\nobody (Local User)
S-1-5-21-2853212168-2008227510-3551253869-502 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-503 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-510 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-511 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-512 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-513 BASIC2\None (Domain Group)
S-1-5-21-2853212168-2008227510-3551253869-514 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-515 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-516 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-517 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-531 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-1049 *unknown*\*unknown* (8)
S-1-5-21-2853212168-2008227510-3551253869-1050 *unknown*\*unknown* (8)

 ============================================= 
|    Getting printer info for 10.10.131.72    |
 ============================================= 
No printers returned.


enum4linux complete on Sun Dec 12 13:46:29 2021

```

Obtenemos que el grupo es «WORKGROUP» y es un servicor samba 4.3.11 en Ubunto, eso ya lo teniamos con nmap,
tambien disponemos de *Anonymous* y que las restricciones de la clave es de al menos 5 caracteres, tambien tenemos los usuarios jan y kay.

![hydra](/assets/images/basic/hydra.png)

